"use strict";!function(c){var e="NYC-RR-",n=e+"static-cache-v1",i=e+"dynamic-cache-v1",a=["/","/index.html","/restaurant.html","/css/styles.css","/js/app.js","/js/main.js","/img/image-fallback.svg","/js/intersection-observer.js","/404.html","/offline.html","/favicon.ico"];function s(e){c.clients.matchAll().then(function(t){t.forEach(function(t){t.postMessage({action:e})})}).catch(function(t){console.log("[SW] Something failed while sending message to clients, error",t)})}c.addEventListener("install",function(t){t.waitUntil(caches.open(n).then(function(t){return t.addAll(a)}).catch(function(t){console.log("[SW] Installation failed, error:",t)}))}),c.addEventListener("activate",function(t){t.waitUntil(caches.keys().then(function(t){return Promise.all(t.filter(function(t){return t.startsWith(e)&&t!==n&&t!==i}).map(function(t){return caches.delete(t)}))}).then(function(){return c.clients.claim()}).catch(function(t){console.log("[SW] Activation failed, error:",t)}))}),c.addEventListener("fetch",function(n){if(n.request.url.startsWith(c.location.origin))if(-1<n.request.url.indexOf("restaurant.html")){if(-1===n.request.url.search(/id=./))return void n.respondWith(caches.match("/404.html"));n.respondWith(caches.match("/restaurant.html"))}else n.respondWith(caches.match(n.request).then(function(t){return t||caches.open(i).then(function(e){return fetch(n.request).then(function(t){return 404===t.status?caches.match("/404.html"):(e.put(n.request,t.clone()).catch(function(t){console.log("[SW] Dynamic caching failed, error",t,n.request.url)}),t)}).catch(function(t){return console.log("[SW] Fetch request failed, error",t),caches.match("/offline.html")})}).catch(function(t){console.log("[SW] Opening dynamic cache failed, error",t)})}).catch(function(t){console.log("[SW] Something failed while matching a request, error",t)}))}),c.addEventListener("message",function(t){"refresh"===t.data.action&&t.waitUntil(c.skipWaiting().then(function(){s("refreshed")}).catch(function(t){console.log("[SW] Something failed while skipping wait, error",t)})),"dismiss"===t.data.action&&t.waitUntil(s("dismissed"))})}(self);
//# sourceMappingURL=sw.js.map
