"use strict";!function(n,d,c){d.addEventListener("DOMContentLoaded",function(){var t=d.getElementById("loading-layer");t&&d.addEventListener("readystatechange",function e(){"complete"===d.readyState&&(t.classList.add("loaded"),setTimeout(function(){d.body.removeChild(t)},400),d.removeEventListener("readystatechange",e))}),function(){function t(e){var t;t=void 0,c.serviceWorker.addEventListener("controllerchange",function(){t||(location.reload(!0),t=!0)});var n=d.createElement("div");n.id="update-alert",n.setAttribute("role","alert");var o=d.createElement("p");o.innerHTML="New version available.";var r=d.createElement("p");r.className="no-wrap";var i=d.createElement("button");i.type="button",i.innerHTML="REFRESH";var s=d.createElement("button");s.type="button",s.innerHTML="DISMISS",r.append(i),r.append(s),n.append(o),n.append(r),d.body.append(n),setTimeout(function(){n.className="open",setTimeout(function(){i.focus(),setTimeout(function(){sessionStorage.dismissed||a(n)},5e3)},300)},1e3),i.addEventListener("click",function(){e.postMessage({action:"refresh"})}),s.addEventListener("click",function(){c.serviceWorker.controller.postMessage({action:"dismiss"}),a(n)})}function n(e){e.addEventListener("statechange",function(){"installed"==this.state&&t(this)})}function a(e){e.classList.remove("open"),d.body.focus(),setTimeout(function(){e.parentNode.removeChild(e)},300)}c.serviceWorker?c.serviceWorker.register("/sw.js").then(function(e){c.serviceWorker.controller&&(c.serviceWorker.addEventListener("message",function(e){"refreshed"===e.data.action&&sessionStorage.removeItem("dismissed"),"dismissed"===e.data.action&&sessionStorage.setItem("dismissed",!0)}),sessionStorage.dismissed||(e.waiting?t(e.waiting):e.installing?n(e.installing):e.addEventListener("updatefound",function(){n(e.installing)})))}).catch(function(e){console.log("[SW] Registration failed, error:",e)}):console.log("Service Worker not supported")}(),function(){if(n.indexedDB){var e=n.indexedDB.open("nyc_rr_data",1);e.onupgradeneeded=function(e){e.target.result.createObjectStore("restaurants",{keyPath:"id"})},e.onerror=function(e){console.log("Database error: ",e.target.errorCode)}}else console.log("IndexedDB not supported")}()})}(window,document,navigator);
//# sourceMappingURL=main.js.map
