"use strict";!function(f,h,o){if(f.fetch){var t,s=void 0,l=[],c=!1;f.initMap=function(){if(o.onLine){var i;s=new google.maps.Map(h.getElementById("map"),{center:{lat:40.722216,lng:-73.987501},zoom:12,scrollwheel:!1,keyboardShortcuts:!1}),u(),i=s.addListener("tilesloaded",function(){var e=h.getElementById("map-container"),t=h.createElement("a");t.className="skip-link button",t.href="#filter-options",t.innerHTML="Skip the map",e.insertAdjacentElement("afterbegin",t);var n=h.createElement("h2");n.id="map-label",n.className="sr-only",n.innerHTML="Google Maps Widget: shows restaurants location",e.insertAdjacentElement("afterbegin",n);var a=h.querySelector('#map div[tabindex="0"]');a.setAttribute("aria-labelledby","map-label");var r=h.getElementById("map");a.addEventListener("focus",function(){r.classList.add("focused")}),a.addEventListener("blur",function(){r.classList.remove("focused")}),r.addEventListener("focus",function(){s.setOptions({keyboardShortcuts:!0})},!0),r.addEventListener("blur",function(){s.setOptions({keyboardShortcuts:!1})},!0),google.maps.event.removeListener(i)})}},t=function(){var e,t,n,a;(function(){var n=h.getElementById("static-map");function a(){var e=h.createElement("script");e.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAxfOOcB40yMKfupF4qyfa4hwvhTclZboA&libraries=places&callback=initMap",e.setAttribute("async",""),h.getElementsByTagName("head")[0].appendChild(e)}function r(){h.getElementById("map").style.display="block",n.removeAttribute("tabindex"),n.removeAttribute("role"),n.removeAttribute("aria-label"),setTimeout(function(){h.querySelector('#map div[tabindex="0"]').focus()},1e3)}n.addEventListener("click",function e(){a(),r(),n.removeEventListener("click",e)}),n.addEventListener("keydown",function e(t){13===t.keyCode&&(a(),r(),n.removeEventListener("keydown",e))})})(),r(),f.addEventListener("resize",function(){requestAnimationFrame(r)}),e=h.getElementById("neighborhoods-select"),t=h.getElementById("cuisines-select"),e.addEventListener("change",u),t.addEventListener("change",u),DBHelper.fetchNeighborhoods().then(i).catch(function(e){console.log(e)}),DBHelper.fetchCuisines().then(d).catch(function(e){console.log(e)}),u(),o.onLine||(n=h.getElementById("static-map"),(a=h.createElement("p")).setAttribute("role","alert"),a.innerHTML="âš  You are offline, map is not available.",n.classList.add("offline"),n.appendChild(a))},"loading"!==h.readyState?t():h.addEventListener("DOMContentLoaded",function e(){t(),h.removeEventListener("DOMContentLoaded",e)})}else console.log("Fetch API not supported");function r(){var e=h.getElementById("static-map"),t=e.clientWidth,n=e.clientHeight,a=640<t||640<n?2:1,r=n<t?+(t/n).toFixed(6):+(n/t).toFixed(6);n<t?(t=640<t?640:t,n=Math.round(t/r)):(n=640<n?640:n,t=Math.round(n/r)),e.style.backgroundImage="url(https://maps.googleapis.com/maps/api/staticmap?center=40.722216,-73.987501&zoom=12&size="+t+"x"+n+"&scale="+a+"&format=jpg&key=AIzaSyAxfOOcB40yMKfupF4qyfa4hwvhTclZboA)"}function i(e){var n=h.getElementById("neighborhoods-select");e.forEach(function(e){var t=h.createElement("option");t.innerHTML=e,t.value=e,n.appendChild(t)})}function d(e){var n=h.getElementById("cuisines-select");e.forEach(function(e){var t=h.createElement("option");t.innerHTML=e,t.value=e,n.appendChild(t)})}function u(){var e=h.getElementById("cuisines-select"),t=h.getElementById("neighborhoods-select"),n=e.selectedIndex,a=t.selectedIndex,r=e[n].value,i=t[a].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(r,i).then(function(e){h.getElementById("restaurants-list").innerHTML="",l.length&&(l.forEach(function(e){return e.setMap(null)}),l=[]),function(e){var t=h.getElementById("results-notice");if(e.length){var n=h.getElementById("restaurants-list");e.forEach(function(e){n.appendChild(function(t){var e=h.createElement("li"),n=h.createElement("article"),a=h.createElement("img");if(a.src="/img/image-placeholder.svg",a.className="restaurant-img",a.alt=t.photoDescription||"The "+t.cuisine_type+" Restaurant "+t.name,t.photograph){var r=h.createElement("picture"),i=h.createElement("source"),o=h.createElement("source");i.sizes="(min-width: 1366px) calc((1366px - 5rem) / 4), (min-width: 1080px) calc((100vw - 4rem) / 3), (min-width: 700px) calc((100vw - 3rem) / 2), calc(100vw - 2rem)",o.sizes=i.sizes,i.srcset=DBHelper.formatSrcset(t),o.srcset=i.srcset.replace(/w.jpg/g,"w.webp"),r.appendChild(a),n.appendChild(r),f.addEventListener("scroll",function e(){a.insertAdjacentElement("beforebegin",o),a.insertAdjacentElement("beforebegin",i),a.src=DBHelper.imageUrlForRestaurant(t,800),f.removeEventListener("scroll",e)})}else n.appendChild(a);var s=h.createElement("h3");s.innerHTML=t.name,n.appendChild(s);var l=h.createElement("p"),c=h.createElement("strong");c.innerHTML=""+t.neighborhood,l.appendChild(c),n.appendChild(l);var d=h.createElement("address"),u=h.createElement("p");u.innerHTML=t.address,d.appendChild(u),n.appendChild(d);var m=h.createElement("p"),p=h.createElement("a");return p.innerHTML="View Details",p.href=DBHelper.urlForRestaurant(t),p.className="button",p.setAttribute("aria-label","View Details about "+t.name),m.appendChild(p),n.appendChild(m),e.appendChild(n),e}(e))});var a=1<e.length?"s":"";t.innerHTML=e.length+" restaurant"+a+" found"}else t.innerHTML="No restaurants found";o.onLine&&function(e){e.forEach(function(e){var t=DBHelper.mapMarkerForRestaurant(e,s);t.addListener("click",function(){f.location.href=t.url}),l.push(t)});var t=new google.maps.OverlayView;if(t.draw=function(){this.getPanes().markerLayer.id="markerLayer"},t.setMap(s),c)m(e);else var n=s.addListener("tilesloaded",function(){m(e),c=!0,google.maps.event.removeListener(n)})}(e)}(e)}).catch(function(e){console.log(e)})}function m(i){setTimeout(function(){for(var e=h.querySelectorAll('[id^="gmimap"]> area'),n=h.querySelectorAll("#markerLayer img"),t=function(t){e[t].tabIndex=0,e[t].addEventListener("focus",function(){n[t].classList.add("focused")}),e[t].addEventListener("blur",function(){n[t].classList.remove("focused")}),e[t].addEventListener("keydown",function(e){13===e.keyCode&&(f.location.href=DBHelper.urlForRestaurant(i[t]))})},a=0;a<e.length;a++)t(a);var r=1<i.length?"s":"";h.querySelector("#map iframe").title="Map shows "+i.length+" restaurant"+r},150)}}(window,document,navigator);
//# sourceMappingURL=index.js.map
