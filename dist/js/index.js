"use strict";!function(f,g,o){if(f.fetch){var t,s=void 0,l=[],c=!1;f.initMap=function(){if(o.onLine){(function(){var e=g.getElementById("static-map");function t(){g.getElementById("map").style.display="block",e.removeAttribute("tabindex"),e.removeAttribute("role"),e.removeAttribute("aria-label"),setTimeout(function(){g.querySelector('#map div[tabindex="0"]').focus()},1e3)}e.addEventListener("click",function(){t()}),e.addEventListener("keydown",function(e){13===e.keyCode&&t()})})(),e(),f.addEventListener("resize",function(){requestAnimationFrame(e)});var i;s=new google.maps.Map(g.getElementById("map"),{center:{lat:40.722216,lng:-73.987501},zoom:12,scrollwheel:!1,keyboardShortcuts:!1}),d(),i=s.addListener("tilesloaded",function(){var e=g.getElementById("map-container"),t=g.createElement("a");t.className="skip-link button",t.href="#filter-options",t.innerHTML="Skip the map",e.insertAdjacentElement("afterbegin",t);var n=g.createElement("h2");n.id="map-label",n.className="sr-only",n.innerHTML="Google Maps Widget: shows restaurants location",e.insertAdjacentElement("afterbegin",n);var a=g.querySelector('#map div[tabindex="0"]');a.setAttribute("aria-labelledby","map-label");var r=g.getElementById("map");a.addEventListener("focus",function(){r.classList.add("focused")}),a.addEventListener("blur",function(){r.classList.remove("focused")}),r.addEventListener("focus",function(){s.setOptions({keyboardShortcuts:!0})},!0),r.addEventListener("blur",function(){s.setOptions({keyboardShortcuts:!1})},!0),google.maps.event.removeListener(i)})}},t=function(){var e,t,n,a;e=g.getElementById("neighborhoods-select"),t=g.getElementById("cuisines-select"),e.addEventListener("change",d),t.addEventListener("change",d),DBHelper.fetchNeighborhoods().then(r).catch(function(e){console.log(e)}),DBHelper.fetchCuisines().then(i).catch(function(e){console.log(e)}),o.onLine||(n=g.getElementById("static-map"),(a=g.createElement("p")).setAttribute("role","alert"),a.innerHTML="âš  You are offline, map is not available.",n.classList.add("offline"),n.append(a),d())},"loading"!==g.readyState?t():g.addEventListener("DOMContentLoaded",function e(){t(),g.removeEventListener("DOMContentLoaded",e)})}else console.log("Fetch API not supported");function e(){var e=g.getElementById("static-map"),t=e.clientWidth,n=e.clientHeight,a=640<t||640<n?2:1,r=n<t?+(t/n).toFixed(6):+(n/t).toFixed(6);n<t?(t=640<t?640:t,n=Math.round(t/r)):(n=640<n?640:n,t=Math.round(n/r)),e.style.backgroundImage="url(https://maps.googleapis.com/maps/api/staticmap?center=40.722216,-73.987501&zoom=12&size="+t+"x"+n+"&scale="+a+"&key=AIzaSyAxfOOcB40yMKfupF4qyfa4hwvhTclZboA)"}function r(e){var n=g.getElementById("neighborhoods-select");e.forEach(function(e){var t=g.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})}function i(e){var n=g.getElementById("cuisines-select");e.forEach(function(e){var t=g.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})}function d(){var e=g.getElementById("cuisines-select"),t=g.getElementById("neighborhoods-select"),n=e.selectedIndex,a=t.selectedIndex,r=e[n].value,i=t[a].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(r,i).then(function(e){g.getElementById("restaurants-list").innerHTML="",l.length&&(l.forEach(function(e){return e.setMap(null)}),l=[]),function(e){var t=g.getElementById("results-notice");if(e.length){var n=g.getElementById("restaurants-list");e.forEach(function(e){n.append(function(t){var e=g.createElement("li"),n=g.createElement("article"),a=g.createElement("img");if(a.src="/img/image-placeholder.svg",a.className="restaurant-img",a.alt=t.photoDescription||"The "+t.cuisine_type+" Restaurant "+t.name,t.photograph){var r=g.createElement("picture"),i=g.createElement("source"),o=g.createElement("source");i.sizes="(min-width: 1366px) calc((1366px - 5rem) / 4), (min-width: 1080px) calc((100vw - 4rem) / 3), (min-width: 700px) calc((100vw - 3rem) / 2), calc(100vw - 2rem)",o.sizes=i.sizes,i.srcset=DBHelper.formatSrcset(t),o.srcset=i.srcset.replace(/w.jpg/g,"w.webp"),r.append(a),n.append(r),f.addEventListener("scroll",function e(){a.insertAdjacentElement("beforebegin",o),a.insertAdjacentElement("beforebegin",i),a.src=DBHelper.imageUrlForRestaurant(t,800),f.removeEventListener("scroll",e)})}else n.append(a);var s=g.createElement("h3");s.innerHTML=t.name,n.append(s);var l=g.createElement("p"),c=g.createElement("strong");c.innerHTML=""+t.neighborhood,l.append(c),n.append(l);var d=g.createElement("address"),u=g.createElement("p");u.innerHTML=t.address,d.append(u),n.append(d);var m=g.createElement("p"),p=g.createElement("a");return p.innerHTML="View Details",p.href=DBHelper.urlForRestaurant(t),p.className="button",p.setAttribute("aria-label","View Details about "+t.name),m.append(p),n.append(m),e.append(n),e}(e))});var a=1<e.length?"s":"";t.innerHTML=e.length+" restaurant"+a+" found"}else t.innerHTML="No restaurants found";o.onLine&&function(e){e.forEach(function(e){var t=DBHelper.mapMarkerForRestaurant(e,s);t.addListener("click",function(){f.location.href=t.url}),l.push(t)});var t=new google.maps.OverlayView;if(t.draw=function(){this.getPanes().markerLayer.id="markerLayer"},t.setMap(s),c)u(e);else var n=s.addListener("tilesloaded",function(){u(e),c=!0,google.maps.event.removeListener(n)})}(e)}(e)}).catch(function(e){console.log(e)})}function u(i){setTimeout(function(){for(var e=g.querySelectorAll('[id^="gmimap"]> area'),n=g.querySelectorAll("#markerLayer img"),t=function(t){e[t].tabIndex=0,e[t].addEventListener("focus",function(){n[t].classList.add("focused")}),e[t].addEventListener("blur",function(){n[t].classList.remove("focused")}),e[t].addEventListener("keydown",function(e){13===e.keyCode&&(f.location.href=DBHelper.urlForRestaurant(i[t]))})},a=0;a<e.length;a++)t(a);var r=1<i.length?"s":"";g.querySelector("#map iframe").title="Map shows "+i.length+" restaurant"+r},150)}}(window,document,navigator);
//# sourceMappingURL=index.js.map
