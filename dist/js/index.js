"use strict";!function(o,f,s){if(o.fetch){var t,l=void 0,c=[],d=!1;o.initMap=function(){if(s.onLine){(function(){var e=f.getElementById("static-map");function t(){f.getElementById("map").style.display="block",e.removeAttribute("tabindex"),e.removeAttribute("role"),e.removeAttribute("aria-label"),setTimeout(function(){f.querySelector('#map div[tabindex="0"]').focus()},1e3)}e.addEventListener("click",function(){t()}),e.addEventListener("keydown",function(e){13===e.keyCode&&t()})})(),e(),o.addEventListener("resize",function(){requestAnimationFrame(e)});var i;l=new google.maps.Map(f.getElementById("map"),{center:{lat:40.722216,lng:-73.987501},zoom:12,scrollwheel:!1,keyboardShortcuts:!1}),u(),i=l.addListener("tilesloaded",function(){var e=f.getElementById("map-container"),t=f.createElement("a");t.className="skip-link button",t.href="#filter-options",t.innerHTML="Skip the map",e.insertAdjacentElement("afterbegin",t);var n=f.createElement("h2");n.id="map-label",n.className="sr-only",n.innerHTML="Google Maps Widget: shows restaurants location",e.insertAdjacentElement("afterbegin",n);var a=f.querySelector('#map div[tabindex="0"]');a.setAttribute("aria-labelledby","map-label");var r=f.getElementById("map");a.addEventListener("focus",function(){r.classList.add("focused")}),a.addEventListener("blur",function(){r.classList.remove("focused")}),r.addEventListener("focus",function(){l.setOptions({keyboardShortcuts:!0})},!0),r.addEventListener("blur",function(){l.setOptions({keyboardShortcuts:!1})},!0),google.maps.event.removeListener(i)})}},t=function(){var e,t,n,a;e=f.getElementById("neighborhoods-select"),t=f.getElementById("cuisines-select"),e.addEventListener("change",u),t.addEventListener("change",u),DBHelper.fetchNeighborhoods().then(r).catch(function(e){console.log(e)}),DBHelper.fetchCuisines().then(i).catch(function(e){console.log(e)}),s.onLine||(n=f.getElementById("static-map"),(a=f.createElement("p")).setAttribute("role","alert"),a.innerHTML="âš  You are offline, map is not available.",n.classList.add("offline"),n.append(a),u())},"loading"!==f.readyState?t():f.addEventListener("DOMContentLoaded",function e(){t(),f.removeEventListener("DOMContentLoaded",e)})}else console.log("Fetch API not supported");function e(){var e=f.getElementById("static-map"),t=e.clientWidth,n=e.clientHeight,a=640<t||640<n?2:1,r=n<t?+(t/n).toFixed(6):+(n/t).toFixed(6);n<t?(t=640<t?640:t,n=Math.round(t/r)):(n=640<n?640:n,t=Math.round(n/r)),e.style.backgroundImage="url(https://maps.googleapis.com/maps/api/staticmap?center=40.722216,-73.987501&zoom=12&size="+t+"x"+n+"&scale="+a+"&key=AIzaSyAxfOOcB40yMKfupF4qyfa4hwvhTclZboA)"}function r(e){var n=f.getElementById("neighborhoods-select");e.forEach(function(e){var t=f.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})}function i(e){var n=f.getElementById("cuisines-select");e.forEach(function(e){var t=f.createElement("option");t.innerHTML=e,t.value=e,n.append(t)})}function u(){var e=f.getElementById("cuisines-select"),t=f.getElementById("neighborhoods-select"),n=e.selectedIndex,a=t.selectedIndex,r=e[n].value,i=t[a].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(r,i).then(function(e){f.getElementById("restaurants-list").innerHTML="",c.length&&(c.forEach(function(e){return e.setMap(null)}),c=[]),function(e){var t=f.getElementById("results-notice");if(e.length){var n=f.getElementById("restaurants-list");e.forEach(function(e){n.append(function(e){var t=f.createElement("li"),n=f.createElement("article"),a=f.createElement("img");if(a.className="restaurant-img",a.alt=e.photoDescription||"The "+e.cuisine_type+" Restaurant "+e.name,e.photograph){var r=f.createElement("picture"),i=f.createElement("source"),o=f.createElement("source");i.sizes="(min-width: 1366px) calc((1366px - 5rem) / 4), (min-width: 1080px) calc((100vw - 4rem) / 3), (min-width: 700px) calc((100vw - 3rem) / 2), calc(100vw - 2rem)",o.sizes=i.sizes,i.srcset=DBHelper.formatSrcset(e),o.srcset=i.srcset.replace(/w.jpg/g,"w.webp"),a.src=DBHelper.imageUrlForRestaurant(e,800),r.append(a),a.insertAdjacentElement("beforebegin",o),a.insertAdjacentElement("beforebegin",i),n.append(r)}else a.src="/img/image-placeholder.svg",n.append(a);var s=f.createElement("h3");s.innerHTML=e.name,n.append(s);var l=f.createElement("p"),c=f.createElement("strong");c.innerHTML=""+e.neighborhood,l.append(c),n.append(l);var d=f.createElement("address"),u=f.createElement("p");u.innerHTML=e.address,d.append(u),n.append(d);var m=f.createElement("p"),p=f.createElement("a");return p.innerHTML="View Details",p.href=DBHelper.urlForRestaurant(e),p.className="button",p.setAttribute("aria-label","View Details about "+e.name),m.append(p),n.append(m),t.append(n),t}(e))});var a=1<e.length?"s":"";t.innerHTML=e.length+" restaurant"+a+" found"}else t.innerHTML="No restaurants found";s.onLine&&function(e){e.forEach(function(e){var t=DBHelper.mapMarkerForRestaurant(e,l);t.addListener("click",function(){o.location.href=t.url}),c.push(t)});var t=new google.maps.OverlayView;if(t.draw=function(){this.getPanes().markerLayer.id="markerLayer"},t.setMap(l),d)m(e);else var n=l.addListener("tilesloaded",function(){m(e),d=!0,google.maps.event.removeListener(n)})}(e)}(e)}).catch(function(e){console.log(e)})}function m(i){setTimeout(function(){for(var e=f.querySelectorAll('[id^="gmimap"]> area'),n=f.querySelectorAll("#markerLayer img"),t=function(t){e[t].tabIndex=0,e[t].addEventListener("focus",function(){n[t].classList.add("focused")}),e[t].addEventListener("blur",function(){n[t].classList.remove("focused")}),e[t].addEventListener("keydown",function(e){13===e.keyCode&&(o.location.href=DBHelper.urlForRestaurant(i[t]))})},a=0;a<e.length;a++)t(a);var r=1<i.length?"s":"";f.querySelector("#map iframe").title="Map shows "+i.length+" restaurant"+r},150)}}(window,document,navigator);
//# sourceMappingURL=index.js.map
